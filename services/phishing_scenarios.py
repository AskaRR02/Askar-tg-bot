from typing import Dict, List, Any

PHISHING_SCENARIOS = [
    {
        "id": "email_login",
        "name": "Почтовый фишинг",
        "description": "Имитация фишингового письма с требованием подтвердить данные",
        "message": (
            "От: security@mail-suрport.com\n"
            "Тема: Срочно: подтвердите вход\n\n"
            "Уважаемый Пользователь,\n\n"
            "Мы заметили попытку входа в ваш аккаунт из Вьетнама.\n"
            "Если это не вы, ваш аккаунт могли взломать.\n\n"
            "Подтвердите свою личность здесь:\n"
            "{phishing_link}\n\n"
            "На ответ у вас 24 часа, потом аккаунт будет заблокирован.\n\n"
            "С уважением,\n"
            "Команда безопасности Mail"
        ),
        "signs": [
            "Опечатки в домене (suрport вместо support)",
            "Создание ложного чувства срочности и угроза блокировки",
            "Отсутствие личного обращения (имени)",
            "Подозрительная ссылка не на официальном домене",
            "Грамматические ошибки и странное форматирование"
        ]
    },
    {
        "id": "prize_win",
        "name": "Выигрыш приза",
        "description": "Мошенническое уведомление о выигрыше",
        "message": (
            "ПОЗДРАВЛЯЕМ! ВЫ ВЫИГРАЛИ АЙФОН 15 ПРО!\n\n"
            "Ваш телефон был случайно выбран среди 1,000 номеров!\n"
            "Для получения подарка укажите данные по ссылке:\n\n"
            "{phishing_link}\n\n"
            "Заполните форму за 30 минут, иначе приз перейдет к другому!"
        ),
        "signs": [
            "Слишком хорошее предложение (бесплатный дорогой гаджет)",
            "Крайне маловероятный сценарий (случайный выбор номера)",
            "Искусственное ограничение времени",
            "Заглавные буквы и восклицательные знаки",
            "Нет данных о компании-организаторе"
        ]
    },
    {
        "id": "bank_alert",
        "name": "Банковское уведомление",
        "description": "Имитация срочного уведомления от банка",
        "message": (
            "ВНИМАНИЕ: подозрительная транзакция\n\n"
            "Уважаемый клиент,\n\n"
            "Мы обнаружили списание 54,990₽ с вашей карты **** 4582.\n"
            "Операция временно приостановлена.\n\n"
            "Для подтверждения или отмены операции:\n"
            "{phishing_link}\n\n"
            "Если вы не ответите в течение 1 часа, карта будет заблокирована.\n\n"
            "Служба безопасности СберБанка"
        ),
        "signs": [
            "Намеренное создание паники (крупная сумма под угрозой)",
            "Отсутствие персонализации (нет обращения по имени)",
            "Давление срочностью и угроза блокировки счета",
            "Подозрительная ссылка не на домене банка",
            "Банки никогда не запрашивают данные карты по ссылкам"
        ]
    }
]


def get_scenarios() -> List[Dict[str, Any]]:
    return [
        {"id": scenario["id"], "name": scenario["name"]}
        for scenario in PHISHING_SCENARIOS
    ]


def get_scenario(scenario_id: str) -> Dict[str, Any]:
    for scenario in PHISHING_SCENARIOS:
        if scenario["id"] == scenario_id:
            return scenario
    return {} 